<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ë°¸ëŸ°ì‹± ê³„ì‚°ê¸° (í”Œë˜í‹°ë„˜ç‰ˆ)</title>
    <meta name="description" content="í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ë°¸ëŸ°ì‹± ê³„ì‚°ê¸°ë¥¼ í†µí•´ ëª©í‘œ ë¹„ìœ¨ì— ë§ì¶° íˆ¬ì ì „ëµì„ ìµœì í™”í•˜ì„¸ìš”.">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-color: #f5f5f5; --text-color: #333; --card-bg: white; --card-shadow: rgba(0,0,0,0.1);
            --border-color: #eee; --accent-color: #667eea; --input-border: #e9ecef; --input-bg: white;
            --header-grad: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --green-grad: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            --orange-grad: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            --blue-grad: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            --grey-grad: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }
        body.dark-mode {
            --bg-color: #1a1a1a; --text-color: #e0e0e0; --card-bg: #2d2d2d; --card-shadow: rgba(0,0,0,0.5);
            --border-color: #444; --input-border: #555; --input-bg: #3d3d3d;
        }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            line-height: 1.6; 
            color: var(--text-color); 
            background-color: var(--bg-color); 
            transition: background-color 0.3s, color 0.3s; 
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { 
            background: var(--header-grad); color: white; padding: 30px; border-radius: 15px; 
            margin-bottom: 30px; text-align: center; box-shadow: 0 10px 30px var(--card-shadow); 
        }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .card { 
            background: var(--card-bg); border-radius: 15px; padding: 25px; 
            margin-bottom: 25px; box-shadow: 0 5px 20px var(--card-shadow); 
            transition: background-color 0.3s, box-shadow 0.3s; 
        }
        .card h2 { color: var(--accent-color); margin-bottom: 20px; font-size: 1.5rem; }
        .btn { 
            background: var(--header-grad); color: white; border: none; padding: 12px 25px; border-radius: 8px; 
            cursor: pointer; font-size: 1rem; font-weight: 600;
        }
        .btn--green { background: var(--green-grad); }
        .btn--orange { background: var(--orange-grad); }
        .btn--blue { background: var(--blue-grad); }
        .btn--grey { background: var(--grey-grad); }
    </style>
    
    <link rel="stylesheet" href="/style.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="/style.css"></noscript>
</head>
<body>
    <button id="darkModeToggle" class="btn dark-mode-toggle" aria-label="ë‹¤í¬ ëª¨ë“œ ì „í™˜">ğŸŒ™</button>
    <div class="container">
        <header class="header">
            <h1>ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ë°¸ëŸ°ì‹± ê³„ì‚°ê¸°</h1>
            <p>ëª©í‘œ ë¹„ìœ¨ì— ë§ì¶° í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì¡°ì •í•˜ëŠ” ìµœì ì˜ ë°©ë²•ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
        </header>

        <main>
            <section class="card">
                <h2>ğŸ“ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬</h2>
                <div class="input-group">
                    <label for="portfolioSelector">í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤:</label>
                    <select id="portfolioSelector" class="input-group__select"></select>
                </div>
                <div class="btn-controls">
                    <button id="newPortfolioBtn" class="btn btn--green">â• ìƒˆë¡œ ë§Œë“¤ê¸°</button>
                    <button id="renamePortfolioBtn" class="btn btn--blue">âœï¸ ì´ë¦„ ë³€ê²½</button>
                    <button id="deletePortfolioBtn" class="btn btn--orange">ğŸ—‘ï¸ ì‚­ì œ</button>
                </div>
            </section>

            <section class="card">
                <h2>âš™ï¸ ê³„ì‚° ëª¨ë“œ ì„ íƒ</h2>
                <div class="mode-selector">
                    <label for="modeAdd"><input type="radio" name="mainMode" value="add" id="modeAdd" checked> â• ì¶”ê°€ ë§¤ìˆ˜ ëª¨ë“œ</label>
                    <label for="modeSell"><input type="radio" name="mainMode" value="sell" id="modeSell"> âš–ï¸ ë§¤ë„ ë¦¬ë°¸ëŸ°ì‹± ëª¨ë“œ</label>
                </div>
            </section>

            <section class="card">
                <h2>ğŸ’¼ í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤ ì„¤ì •</h2>
                <div class="btn-controls">
                    <button id="addNewStockBtn" class="btn btn--green">â• ìƒˆ ì¢…ëª© ì¶”ê°€</button>
                    <button id="resetDataBtn" class="btn btn--orange">ğŸ”„ ì´ˆê¸°í™”</button>
                    <button id="normalizeRatiosBtn" class="btn btn--blue">âš–ï¸ ë¹„ìœ¨ ìë™ ë§ì¶¤(100%)</button>
                    <button id="saveDataBtn" class="btn btn--blue">ğŸ’¾ ì €ì¥</button>
                    <button id="loadDataBtn" class="btn btn--grey">ğŸ“‚ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                    <button id="exportDataBtn" class="btn btn--blue">ğŸ“¤ ë‚´ë³´ë‚´ê¸° (JSON)</button>
                    <button id="importDataBtn" class="btn btn--grey">ğŸ“¥ ê°€ì ¸ì˜¤ê¸° (JSON)</button>
                    <input type="file" id="importFileInput" accept=".json" style="display: none;">
                </div>
                <div class="table-responsive">
                    <table id="portfolioTable">
                        <thead id="portfolioTableHead"></thead>
                        <tbody id="portfolioBody"></tbody>
                    </table>
                </div>
                <div id="ratioValidator" class="ratio-validator">
                    <strong>ëª©í‘œ ë¹„ìœ¨ í•©ê³„:</strong>
                    <span class="ratio-value" id="ratioSum">0%</span>
                </div>
            </section>

            <section id="addInvestmentCard" class="card">
                <h2>ğŸ’° ì¶”ê°€ íˆ¬ìê¸ˆ ê³„ì‚°</h2>
                <div class="mode-selector">
                    <label for="currencyKRW"><input type="radio" name="currencyMode" value="krw" id="currencyKRW" checked> ì›í™”(KRW) ê¸°ì¤€</label>
                    <label for="currencyUSD"><input type="radio" name="currencyMode" value="usd" id="currencyUSD"> ë‹¬ëŸ¬(USD) ê¸°ì¤€</label>
                </div>
                <div id="exchangeRateGroup" class="input-group hidden">
                    <label for="exchangeRate">í™˜ìœ¨ (1 USD):</label>
                    <input type="number" id="exchangeRate" placeholder="ì˜ˆ: 1300" min="0.01" step="0.01" value="1300">
                </div>
                <div class="input-group">
                    <label for="additionalAmount">ì¶”ê°€ íˆ¬ì ê¸ˆì•¡:</label>
                    <input type="number" id="additionalAmount" placeholder="ì˜ˆ: 1000000" min="0">
                    <span id="usdInputGroup" class="hidden" style="display: contents;">
                        <span style="margin: 0 10px;">ë˜ëŠ”</span>
                        <label for="additionalAmountUSD" class="hidden">USD</label>
                        <input type="number" id="additionalAmountUSD" placeholder="ì˜ˆ: 1000" min="0" step="0.01">
                        <span>USD</span>
                    </span>
                </div>
            </section>
            
            <button id="calculateBtn" class="btn" style="width: 100%; padding: 15px; font-size: 1.2rem; margin-bottom: 25px;">ê³„ì‚°í•˜ê¸°</button>
            
            <section id="resultsSection" class="hidden" aria-live="polite"></section>
            <section id="sectorAnalysisSection" class="hidden"></section>
            <section id="chartSection" class="card hidden">
                <h2>ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤ ì‹œê°í™”</h2>
                <div>
                    <canvas id="portfolioChart"></canvas>
                </div>
            </section>
        </main>
    </div>

    <div id="transactionModal" class="modal-overlay hidden">
        <div class="modal-content card">
            <div class="modal-header">
                <h2 id="modalStockName">ê±°ë˜ ë‚´ì—­ ê´€ë¦¬</h2>
                <button id="closeModalBtn" class="modal-close-btn" aria-label="ë‹«ê¸°">&times;</button>
            </div>
            
            <div class="table-responsive" style="margin-bottom: 20px;">
                <table id="transactionTable">
                    <caption>ê±°ë˜ ë‚´ì—­ ëª©ë¡</caption>
                    <thead>
                        <tr>
                            <th>ë‚ ì§œ</th><th>ì¢…ë¥˜</th><th>ìˆ˜ëŸ‰</th><th>ë‹¨ê°€</th><th>ì´ì•¡</th><th>ì‘ì—…</th>
                        </tr>
                    </thead>
                    <tbody id="transactionListBody"></tbody>
                </table>
            </div>

            <form id="newTransactionForm">
                <h3>ìƒˆ ê±°ë˜ ì¶”ê°€</h3>
                <div class="mode-selector" style="margin-bottom: 15px;">
                    <label><input type="radio" name="txType" value="buy" checked> ë§¤ìˆ˜</label>
                    <label><input type="radio" name="txType" value="sell"> ë§¤ë„</label>
                </div>
                <div class="input-grid">
                    <div class="input-group-vertical">
                        <label for="txDate">ë‚ ì§œ</label>
                        <input type="date" id="txDate" required>
                    </div>
                    <div class="input-group-vertical">
                        <label for="txQuantity">ìˆ˜ëŸ‰</label>
                        <input type="number" id="txQuantity" placeholder="ì˜ˆ: 10" min="0" step="any" required>
                    </div>
                    <div class="input-group-vertical">
                        <label for="txPrice">ë‹¨ê°€</label>
                        <input type="number" id="txPrice" placeholder="ì˜ˆ: 150000" min="0" step="any" required>
                    </div>
                </div>
                <button type="submit" class="btn btn--blue" style="width: 100%; margin-top: 15px;">ğŸ’¾ ê±°ë˜ ì¶”ê°€</button>
            </form>
        </div>
    </div>

    <script type="module" src="/js/main.js"></script>
</body>
</html>